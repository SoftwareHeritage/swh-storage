#!/usr/bin/make -f

# To activate more logs
# export SWH_CASSANDRA_LOGS=1
export PYBUILD_NAME=swh.storage
export PYTEST_PLUGINS="swh.storage.pytest_plugin"
export PYBUILD_TEST_ARGS=-x -v -m "not db and not fs and not network" \
	--hypothesis-profile=fast ./swh/storage/tests

%:
	dh $@ --with python3 --buildsystem=pybuild

override_dh_install:
	dh_install
	rm -rfv $(CURDIR)/debian/python3-*/usr/lib/python*/dist-packages/.hypothesis
	rm -v $(CURDIR)/debian/python3-*/usr/lib/python*/dist-packages/swh/__init__.py
